var O2 = require('o2');
var CONST = require('../data/consts.js');
var Effect = require('../Effects.js');
var Book = require('./Abstract/Book.js');
var u = require('../Utils.js');

/**
 * spellbook of remind
 * Supprime tous les cooldown actuellement actif, rendant les sorts
 * immédiatement réutilisables
 */
var BookRemind = O2.extendClass(Book, {
	cooldown: CONST.SPELL_DURATION_LEVEL[6],
	BOOK_OF_REMIND: true,

	read: function(ctx) {
		var oEntity = ctx.caster; // getTarget() // target
		var oInstance = ctx.instance;
		var oInventory = oEntity.getData('inventory');
		oInventory.aBagSlots.forEach(function(o, iItem) {
			if ((!!o) && (o.type === 'spellbook') && (!o.BOOK_OF_REMIND)) {
				o.clearCooldown();
				oInstance.pushNetworkMessage([oEntity], {
					m: 'cooldown',
					n: 0,
					i: iItem
				});
			}
		});
	}
});

module.exports = BookRemind;
